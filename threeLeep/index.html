<html>
  <head>
    <title>Let's learn sign language</title>
    <script src="//cdnjs.cloudflare.com/ajax/libs/three.js/r66/three.js"></script>
    <script src="//js.leapmotion.com/leap-0.6.2.min.js"></script>
    <script src="//js.leapmotion.com/leap-plugins-0.1.6.1.js"></script>
    <script src="//js.leapmotion.com/leap.rigged-hand-0.1.3.min.js"></script>
    <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>

    <style>
      body{
        font-family: 'Myriad Pro', Helvetica, Arial, 'Lucida Grande', sans-serif;
        font-size: 24pt;
        color: white;
        background-color: steelblue;
      }
      label {
        position: fixed;
        white-space: nowrap;
      }
    </style>
  </head>

  <body>
    <div id="labels">
        <p id = "feedback">Testing</p>
    </div>
  </body>

  <script type="text/javascript" class="codepen">

    var riggedHandPlugin;
    var handPresent = false,
        successful  = true;

    function chooseNewNumber(){
        //place holder
        var max = 9,
            min = 0;
        return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    Leap.loop({
      hand: function(hand){
        var label = hand.data('label'); //the labeling of the hands

        if (!label){

          label = document.createElement('label');
          document.body.appendChild(label);

          /**
           * Here we set the label to show the hand type
           */
          //label.innerHTML = hand.type + " hand";

          var message;

          if (successful){
          if (hand.type == "left"){
              message = ""
          } else {
              message = "0"
          }
          label.innerHTML = message;

          hand.data('label', label)

        }
        } //end of succesful if statement

        var handMesh = hand.data('riggedHand.mesh');

        var grip = hand.grabStrength

        if (grip > 0.9 && handPresent){
            d3.select("body").style("background-color", "green")
            d3.select("#feedback").text("Good Job!")

        } else {
            d3.select("body").style("background-color", "steelblue")
        }

        var screenPosition = handMesh.screenPosition(
          hand.palmPosition,
          riggedHandPlugin.camera
        );

        label.style.left = screenPosition.x + 50 + 'px';
        label.style.bottom = screenPosition.y + 'px';

      }
    })
    .use('riggedHand')
    .use('handEntry')
    .on('handLost', function(hand){
        if (handPresent){
            d3.select("#feedback").text("Try signing the number!")
            handPresent = false
        } else {
            handPresent = true
        }
        console.log(handPresent)
        var label = hand.data('label');
        if (label){
          document.body.removeChild(label);
          hand.data({label: undefined});
        }
    })
    .on('handEntry', function(){
        handPresent = true
    })
    .use('playback', {
      recording: 'leap-playback-recording-100fps.json.lz', //recording of hand movement
      timeBetweenLoops: 1000
    });

    riggedHandPlugin = Leap.loopController.plugins.riggedHand;

  </script>
</html>
