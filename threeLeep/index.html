<html>
  <head>
    <title>Let's learn sign language</title>
    <script src="//cdnjs.cloudflare.com/ajax/libs/three.js/r66/three.js"></script>
    <script src="//js.leapmotion.com/leap-0.6.2.min.js"></script>
    <script src="//js.leapmotion.com/leap-plugins-0.1.6.1.js"></script>
    <script src="//js.leapmotion.com/leap.rigged-hand-0.1.3.min.js"></script>
    <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>

    <style>
      body{
        font-family: optima;
        font-size: 40pt;
        color: white;
        background-color: steelblue;
      }

      /*label {
        position: fixed;
        white-space: nowrap;
      }*/
    </style>
  </head>

  <body>
    <div id="labels">
        <p id = "feedback">Testing</p>
    </div>
  </body>

  <script type="text/javascript" class="codepen">

    var riggedHandPlugin;

    var handPresent = false,
        successful  = false;

    function chooseNewNumber(){
        var max = 9,
            min = 0;
        return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    Leap.loop({

      hand: function(hand){

        var handMesh = hand.data('riggedHand.mesh');

        var fingers = hand.fingers,
            thumb   = fingers[0].extended,
            index   = fingers[1].extended,
            middle  = fingers[2].extended,
            ring    = fingers[3].extended,
            pinky   = fingers[4].extended,
            currentlySigning;

        //Where all the magic happens!
        if (!thumb && index && !middle && !ring && !pinky) {
            currentlySigning = 1
        } else if(!thumb && index && middle && !ring && !pinky){
            currentlySigning = 2
        } else if (thumb && index && middle && !ring && !pinky){
            currentlySigning = 3
        } else if (!thumb && index && middle && ring && pinky){
            currentlySigning = 4
        } else if (thumb && index && middle && ring && pinky){
            currentlySigning = 5
        } else if (!thumb && index && middle && ring && !pinky){
            currentlySigning = 6
        } else if (!thumb && index && middle && !ring && pinky){
            currentlySigning = 7
        } else if (!thumb && index && !middle && ring && pinky){
            currentlySigning = 8
        } else if (!thumb && !index && middle && ring && pinky){
            currentlySigning = 9
        } else {
            currentlySigning = "Show me a number!"
        }


        d3.select("#feedback").text(currentlySigning)

        var screenPosition = handMesh.screenPosition(
          hand.palmPosition,
          riggedHandPlugin.camera
        );


      }
    })
    .use('riggedHand')
    .use('handEntry')
    .on('handLost', function(hand){

        if (handPresent){
            d3.select("#feedback").text("Try signing the number!")
            handPresent = false
        } else {
            handPresent = true
        }
        console.log(handPresent)
        var label = hand.data('label');
        if (label){
          document.body.removeChild(label);
          hand.data({label: undefined});
        }
    })
    .on('handEntry', function(){
        handPresent = true
    })
    .use('playback', {
      recording: 'leap-playback-recording-100fps.json.lz', //recording of hand movement
      timeBetweenLoops: 1000
    });

    riggedHandPlugin = Leap.loopController.plugins.riggedHand;

  </script>
</html>
